# SQL Beginner #2
{:.no_toc}

* toc
{:toc}

## テーブルを出力する
SELECT"句"、FROM"句"と句という表現をすることが一般的。

```sql
SELECT * FROM items;
```

## 列を選択してテーブルを出力する（射影）
```sql
SELECT id, name FROM items;
+----+-----------------------+
| id | name                  |
+----+-----------------------+
|  1 | Tシャツ               |
|  2 | 穴あけパンチ          |
|  3 | カッターシャツ        |
|  4 | 包丁                  |
|  5 | 圧力鍋                |
|  6 | フォーク              |
|  7 | おろしがね            |
|  8 | ボールペン            |
|  9 | プロテイン            |
+----+-----------------------+
```

## 行を選択してテーブルを出力する（選択）
```sql
SELECT * FROM items WHERE id = 1;
+----+------------+--------+-------+------+---------------+
| id | name       | genre  | price | cost | registered_at |
+----+------------+--------+-------+------+---------------+
|  1 | Tシャツ    | 衣服   |  1000 |  500 | 2009-09-20    |
+----+------------+--------+-------+------+---------------+
```

## 列に別名を付与
ORMでPOJOを調整するのではなくAS句で出力する結果セットを調整する手段もある。

```sql
SELECT
  id,
  name AS 商品名,
  genre AS ジャンル,
  price AS 価格,
  cost AS 原価,
  registered_at AS 登録日
FROM items
WHERE id = 1;
+----+------------+--------------+--------+--------+------------+
| id | 商品名     | ジャンル     | 価格   | 原価   | 登録日     |
+----+------------+--------------+--------+--------+------------+
|  1 | Tシャツ    | 衣服         |   1000 |    500 | 2009-09-20 |
+----+------------+--------------+--------+--------+------------+
```

## 定数の出力
```sql
SELECT 1 AS constant;
+----------+
| constant |
+----------+
|        1 |
+----------+

SELECT id, name, 1 AS constant FROM items WHERE id IN (1, 2, 3);
+----+-----------------------+----------+
| id | name                  | constant |
+----+-----------------------+----------+
|  1 | Tシャツ               |        1 |
|  2 | 穴あけパンチ          |        1 |
|  3 | カッターシャツ        |        1 |
+----+-----------------------+----------+
```

## 重複の排除
```sql
SELECT DISTINCT genre FROM items;
+--------------------+
| genre              |
+--------------------+
| 衣服               |
| 事務用品           |
| キッチン用品       |
| 食品               |
+--------------------+

-- 複数の列の組み合わせで重複を排除できる。
SELECT DISTINCT genre, registered_at FROM items;
+--------------------+---------------+
| genre              | registered_at |
+--------------------+---------------+
| 衣服               | 2009-09-20    |
| 事務用品           | 2009-09-11    |
| 衣服               | NULL          |
| キッチン用品       | 2009-09-20    |
| キッチン用品       | 2009-01-15    |
| キッチン用品       | 2008-04-28    |
| 事務用品           | 2009-11-11    |
| 食品               | 2023-10-14    |
+--------------------+---------------+
```

## 選択と射影の順序
以下のSQLでは`genre = '衣服'`の条件式が行単位に適用されて選択された後に射影が行われる。

```sql
SELECT id, name, genre FROM items WHERE genre = '衣服';
+----+-----------------------+--------+
| id | name                  | genre  |
+----+-----------------------+--------+
|  1 | Tシャツ               | 衣服   |
|  3 | カッターシャツ        | 衣服   |
+----+-----------------------+--------+
```

## WHERE 1 / WHERE 0
WHERE句は行単位で論理式を判定して真となった行を選択する。

```sql
SELECT COUNT(*) FROM items WHERE 1; -- 9
SELECT COUNT(*) FROM items WHERE 0; -- 0
SELECT COUNT(*) FROM items WHERE true; -- 9
SELECT COUNT(*) FROM items WHERE false; -- 0
```

## コメントの記述
```sql
-- コメントを記述できる。
SELECT * FROM items;

/* 複数行の
   コメントを記述できる。*/
SELECT * FROM items;

SELECT * FROM items; -- SQL文の後にもコメントを記述できる。

SELECT
  id, -- 複数行のSQL文の各行にも
  name -- コメントを記述できる。
FROM items;
```
